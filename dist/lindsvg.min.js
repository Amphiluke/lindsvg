/*!
lindsvg v1.3.3
https://amphiluke.github.io/lindsvg/
(c) 2023 Amphiluke
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).lindsvg={})}(this,(function(t){"use strict";let e={AXIOM:"Axiom may only contain the following characters: A..Z,+,-,[,]",RULE:"Production rules may only contain the following characters: A..Z,+,-,[,]",LETTER:"Allowed alphabet letters are: A..Z",ALPHA:"The “alpha” parameter must be a finite number",THETA:"The “theta” parameter must be a finite number",STEP:"The “step” parameter must be a positive finite number",COUNT:"The number of iterations must be integer and finite",NUMBER:"A valid finite number expected"},i=/^[A-Z]$/;let a=/^[A-Z+\-[\]]*$/;function n(t,i=e.RULE){return a.test(t)||i}function r(t,a,r){let s=Object.create(null);return Object.entries(t).forEach((([t,h])=>{let o=function(t,a=e.LETTER){return i.test(t)||a}(t,a);!0===o&&(o=n(h,r)),!0!==o&&(s[t]=o)})),!Object.keys(s).length||s}function s(t){let i=Object.create(null);return Object.entries(t).forEach((([t,a])=>{let s=!0;switch(t){case"axiom":s=n(a,e.AXIOM);break;case"rules":s=r(a);break;case"alpha":case"theta":s=function(t,i=e.NUMBER){return Number.isFinite(t)||i}(a,e[t.toUpperCase()]);break;case"step":s=function(t,i=e.STEP){return Number.isFinite(t)&&t>0||i}(a);break;case"iterations":s=function(t,i=e.COUNT){return Number.isInteger(t)&&t>0||i}(a)}!0!==s&&(i[t]=s)})),!Object.keys(i).length||i}class h extends Error{constructor(t){let e=JSON.stringify(t,null,2);super(e),Object.defineProperty(this,"lsErrors",{value:JSON.parse(e)})}toJSON(){return JSON.parse(JSON.stringify(this.lsErrors))}}Object.defineProperty(h.prototype,"name",{configurable:!0,enumerable:!1,writable:!0,value:"LSError"});let o={F:"",B:"","+":"+","-":"-","[":"[","]":"]"},c={alpha:0,theta:0,step:10,iterations:3};function l(t){let e=s(t);if(!0!==e)throw new h(e);let{axiom:i,iterations:a}={...c,...t},n={...o,...t.rules};for(;a>0;a--)i=[...i].reduce(((t,e)=>t+(n[e]||"")),"");return function(t){let e=t.replace(/[^FB[\]+-]/g,"");do{t=e,e=e.replace(/\[[^F[\]]*]/g,"")}while(e!==t);return e}(i)}function u(t){return t.match(/([FB[\]+-])\1*/g)}class p{constructor({x:t,y:e,step:i,alpha:a,theta:n}){this.stack=[],this.x=this.minX=this.maxX=t,this.y=this.minY=this.maxY=e,this.step=i,this.alpha=-a,this.theta=n}translate(t=1){this.x+=t*this.step*Math.cos(this.alpha),this.y+=t*this.step*Math.sin(this.alpha),this.minX=Math.min(this.minX,this.x),this.maxX=Math.max(this.maxX,this.x),this.minY=Math.min(this.minY,this.y),this.maxY=Math.max(this.maxY,this.y)}rotate(t){this.alpha+=t*this.theta}pushStack(t=1){for(;t>0;t--)this.stack.push({x:this.x,y:this.y,alpha:this.alpha})}popStack(t){for(;t>0;t--)({x:this.x,y:this.y,alpha:this.alpha}=this.stack.pop())}getDrawingRect(){let t=Math.floor(this.minX),e=Math.floor(this.minY),i=Math.ceil(this.maxX),a=Math.ceil(this.maxY);return{minX:t,minY:e,maxX:i,maxY:a,width:i-t,height:a-e}}}function f(t,e){return`${+t.toFixed(4)} ${+e.toFixed(4)}`}function m(t){return t.replace(/(?:M-?\d+(?:\.\d+)? -?\d+(?:\.\d+)?)+(?=M|$)/g,"")}function d(t){let e=l(t),i=new p({x:0,y:0,...t}),a=function(t,e){let i;return m(t.reduce(((t,a)=>{let n=a.length;switch(a[0]){case"F":e.translate(n),t+=("L"===i?" ":"L")+f(e.x,e.y),i="L";break;case"B":e.translate(n),"M"===i&&(t=t.slice(0,t.lastIndexOf("M"))),t+="M"+f(e.x,e.y),i="M";break;case"+":e.rotate(n);break;case"-":e.rotate(-n);break;case"[":e.pushStack(n);break;case"]":e.popStack(n),t+=`M${f(e.x,e.y)}`,i="M"}return t}),"M"+f(e.x,e.y)))}(u(e),i);return{pathData:a,...i.getDrawingRect()}}function g(t){let e=l(t),i=new p({x:0,y:0,...t}),a=function(t,e){let i,a=0;return t.reduce(((t,n)=>{let r=t[a]||"",s=n.length;switch(n[0]){case"F":e.translate(s),r+=("L"===i?" ":"L")+f(e.x,e.y),i="L";break;case"B":e.translate(s),"M"===i&&(r=r.slice(0,r.lastIndexOf("M"))),r+="M"+f(e.x,e.y),i="M";break;case"+":e.rotate(s);break;case"-":e.rotate(-s);break;case"[":a+=s,e.pushStack(s),r=`${t[a]||""}M${f(e.x,e.y)}`,i="M";break;case"]":a-=s,e.popStack(s),r=`${t[a]||""}M${f(e.x,e.y)}`,i="M"}return t[a]=r,t}),["M"+f(e.x,e.y)]).filter((t=>t.includes("L"))).map(m)}(u(e),i);return{multiPathData:a,...i.getDrawingRect()}}function x(t,e,i){return{width:t.width||e,height:t.height||i,padding:t.padding||0,pathAttributes:{fill:t.fill||"none",stroke:t.stroke||"#000",...t.pathAttributes}}}function b({viewBox:t,width:e,height:i,content:a}){return`<svg xmlns="http://www.w3.org/2000/svg" viewBox="${t.join(" ")}" height="${i}" width="${e}">${a}</svg>`}function y(t,e){return Object.entries(t).reduce(((t,[i,a])=>(Array.isArray(a)&&(a=a[Math.min(e,a.length-1)]),void 0===a||"n/a"===a.toLowerCase()?t:`${t} ${i}="${a=a.replace(/"/g,"&quot;")}"`)),"")}t.getMultiPathSVGCode=function(t,e){let{multiPathData:i,minX:a,minY:n,width:r,height:s}=g(t),{padding:h,width:o,height:c,pathAttributes:l}=x(e,r,s);return b({viewBox:[a-h,n-h,r+2*h,s+2*h],width:o,height:c,content:i.reduce(((t,e,i)=>`${t}<path d="${e}"${y(l,i)}></path>`),"")})},t.getMultiPathSVGData=g,t.getSVGCode=function(t,e){let{pathData:i,minX:a,minY:n,width:r,height:s}=d(t),{padding:h,width:o,height:c,pathAttributes:l}=x(e,r,s);return b({viewBox:[a-h,n-h,r+2*h,s+2*h],width:o,height:c,content:`<path d="${i}"${y(l,0)}></path>`})},t.getSVGData=d}));
